# Keystone Notary Group

This is a small React site styled with Tailwind CSS.

The application includes basic Progressive Web App (PWA) support with an
offline-capable service worker and web app manifest.

## Analytics

Google Analytics 4 tracking is included with privacy-friendly defaults. Set the
`REACT_APP_GA_ID` environment variable before running `npm run build`. The build
script will inject this ID into `build/index.html` in place of the placeholder
value, keeping the source file free of sensitive data. Adjust the consent logic
as needed.
Optional snippets for Hotjar or Microsoft Clarity are also provided in the head
section but are disabled by default.

## Requirements

 - Node.js 20 or later

## Getting Started

This project uses npm overrides to pin certain transitive dependencies to secure versions.

1. Install dependencies: `npm install`
   - This runs `patch-package` to apply local patches in the `patches/` directory.
2. Start the development server: `npm start`
3. Build for production: `npm run build`
4. Run tests: `npm test`

**Note**: The `SITEMAP_BASE_URL` environment variable controls the base URL
used in `public/sitemap.xml`. Set this variable before running
`npm run build` or `npm run generate-sitemap` to ensure links point to the
correct domain. Any trailing slash will be removed automatically so either
`https://example.com` or `https://example.com/` work the same.

## Project Structure

- `src/` - React components and pages
- `public/` - Static assets and HTML template
- `react-helmet-async` manages document head tags via a provider in `src/index.js`

## Analytics

The site integrates [Google Analytics](https://analytics.google.com/) using the
GA4 tag. The script loads asynchronously via Google Tag Manager so it does not
block page rendering. During the build step, `scripts/inject-ga.js` replaces the
`GA_MEASUREMENT_ID` placeholder in `public/index.html` with the value of
`REACT_APP_GA_ID`, so no manual edits are required.

- `build/` - Production-ready assets generated by `npm run build`

## Updating the Service Worker

1. Modify `public/service-worker.js` as needed. Bump the `CACHE_NAME` constant to force clients to update.
2. Add any new assets or pages (like `offline.html`) to the pre-cache list.
3. Run `npm run build` to generate the production files.
4. Deploy the contents of the `build/` directory to your hosting provider.

## Testing Offline Support

1. Start the development server with `npm start`.
2. Open the site in a browser and verify the service worker registers without errors (check DevTools > Application > Service Workers).
3. With DevTools open, set the network mode to "Offline" and refresh the page to confirm the cached assets and offline page load correctly.
4. Run `npm test` to execute unit tests.

## License

This project is licensed under the [MIT License](LICENSE).

